# Логическая модель базы данных "ВинТех"

![Логическая модель](docs/logical_model/logical_model.png)

## Общее описание
Логическая модель представляет собой нормализованное представление структуры данных для системы управления винной картой. Модель соответствует 3-й нормальной форме (3НФ) и включает 8 сущностей с явно выраженными связями.

## Нормализация
1. **1НФ**:
   - Все атрибуты атомарны
   - Отсутствуют повторяющиеся группы

2. **2НФ**:
   - Все неключевые атрибуты полностью зависят от первичного ключа
   - Пример: в `inventory` составной ключ (wine_id + location_id) определяет quantity

3. **3НФ**:
   - Нет транзитивных зависимостей
   - Пример: `country` в `locations` не зависит от `city`

## Особенности реализации

### Версионирование цен
- **SCD Type 4**: Таблица `wine_price_history` реализует подход Slowly Changing Dimension Type 4 (исторические данные в отдельной таблице)
- **Временные метки**: 
  - `start_date` - дата начала действия цены (NOT NULL)
  - `end_date` - дата окончания действия цены (CHECK: end_date > start_date)
- **Текущая цена**: Флаг `is_current BOOLEAN DEFAULT TRUE` обеспечивает быстрый доступ к актуальным ценам

### Инвенторизация
- **Составной ключ**: Первичный ключ таблицы `inventory` состоит из пар `(wine_id, location_id)`
- **Контроль остатков**: Ограничение `CHECK (quantity >= 0)` гарантирует невозможность отрицательного количества товара

### Типизация данных
- **ENUM типы**:
  - `type ENUM('красное','белое','роза','игристое')` для вин
  - `type ENUM('online','offline')` для магазинов
- **Финансы**: `DECIMAL(10,2)` для точного хранения цен (10 цифр, 2 знака после запятой)
- **Даты**: `YEAR` для компактного хранения года производства вин
